<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:MilOps.ViewModels"
             x:Class="MilOps.Views.ScheduleCreateView"
             x:DataType="vm:ScheduleCreateViewModel"
             DataContext="{x:Null}">

  <Grid Background="#000000">
    <!-- ê¶Œí•œ ì—†ìŒ ë©”ì‹œì§€ -->
    <Border IsVisible="{Binding !HasPermission}"
            Background="#1A1A1A" CornerRadius="8" Padding="20"
            VerticalAlignment="Center" HorizontalAlignment="Center" Margin="20">
      <StackPanel Spacing="10" HorizontalAlignment="Center">
        <TextBlock Text="ê¶Œí•œ ì—†ìŒ" FontSize="18" Foreground="#F44336" HorizontalAlignment="Center"/>
        <TextBlock Text="ì¼ì • ìƒì„±ì€ ì‚¬ë‹¨ë‹´ë‹¹ìžë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤." FontSize="13" Foreground="#888888"
                   TextWrapping="Wrap" HorizontalAlignment="Center"/>
        <Button Command="{Binding CloseCommand}" Background="#555555" Padding="20,10" CornerRadius="6"
                HorizontalAlignment="Center" Margin="0,10,0,0">
          <TextBlock Text="ë‹«ê¸°" Foreground="White" FontSize="13"/>
        </Button>
      </StackPanel>
    </Border>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <Grid IsVisible="{Binding HasPermission}" RowDefinitions="Auto,*">
      <!-- í—¤ë” -->
      <Border Grid.Row="0" Background="#1A1A1A" Padding="10">
        <Grid ColumnDefinitions="Auto,*">
          <Button Grid.Column="0" Command="{Binding CloseCommand}"
                  Background="Transparent" Padding="8,4">
            <TextBlock Text="â† ë’¤ë¡œ" Foreground="White" FontSize="14"/>
          </Button>
          <TextBlock Grid.Column="1" Text="ðŸ—“ï¸ ì¼ì • ìƒì„±" FontSize="16" Foreground="White"
                     HorizontalAlignment="Center" VerticalAlignment="Center" Margin="-50,0,0,0"/>
        </Grid>
      </Border>

      <!-- í¼ ì»¨í…ì¸  -->
      <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Disabled">
        <StackPanel Margin="16" Spacing="16">
          <!-- í˜„ìž¬ ì‚¬ìš©ìž ì •ë³´ -->
          <Border Background="#FF980020" CornerRadius="8" Padding="12">
            <TextBlock Text="{Binding CurrentUserDisplay}" FontSize="14" Foreground="#FF9800"
                       HorizontalAlignment="Center"/>
          </Border>

          <!-- ë¡œë”© -->
          <TextBlock Text="ë¡œë”©ì¤‘..." IsVisible="{Binding IsLoading}"
                     Foreground="#888888" HorizontalAlignment="Center" FontSize="13"/>

          <!-- ì„±ê³µ ë©”ì‹œì§€ -->
          <Border Background="#2E7D32" CornerRadius="6" Padding="10"
                  IsVisible="{Binding SuccessMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
            <TextBlock Text="{Binding SuccessMessage}" Foreground="White" FontSize="12"
                       HorizontalAlignment="Center"/>
          </Border>

          <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
          <Border Background="#C62828" CornerRadius="6" Padding="10"
                  IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
            <TextBlock Text="{Binding ErrorMessage}" Foreground="White" FontSize="12"
                       HorizontalAlignment="Center" TextWrapping="Wrap"/>
          </Border>

          <!-- ìƒˆ ì¼ì • ìƒì„± ì„¹ì…˜ -->
          <Border Background="#1A1A1A" CornerRadius="10" Padding="16">
            <StackPanel Spacing="14">
              <TextBlock Text="ìƒˆ ì¼ì • ìƒì„±" FontSize="15" Foreground="White" FontWeight="Bold"/>

              <!-- ì§€ìžì²´ (ì‹œ/ë„) -->
              <StackPanel Spacing="4">
                <TextBlock Text="ì§€ìžì²´ (ì‹œ/ë„)" Foreground="#AAAAAA" FontSize="12"/>
                <ComboBox ItemsSource="{Binding Regions}"
                          SelectedItem="{Binding SelectedRegion}"
                          Background="#333333"
                          Foreground="White"
                          HorizontalAlignment="Stretch"
                          PlaceholderText="ì‹œ/ë„ ì„ íƒ">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}"/>
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
              </StackPanel>

              <!-- ì§€ìžì²´ (êµ¬/êµ°) -->
              <StackPanel Spacing="4">
                <TextBlock Text="ì§€ìžì²´ (êµ¬/êµ°)" Foreground="#AAAAAA" FontSize="12"/>
                <ComboBox ItemsSource="{Binding Districts}"
                          SelectedItem="{Binding SelectedDistrict}"
                          Background="#333333"
                          Foreground="White"
                          HorizontalAlignment="Stretch"
                          PlaceholderText="êµ¬/êµ° ì„ íƒ"
                          IsEnabled="{Binding SelectedRegion, Converter={x:Static ObjectConverters.IsNotNull}}">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}"/>
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
              </StackPanel>

              <!-- ë‹´ë‹¹ëŒ€ëŒ€ -->
              <StackPanel Spacing="4">
                <TextBlock Text="ë‹´ë‹¹ëŒ€ëŒ€" Foreground="#AAAAAA" FontSize="12"/>
                <ComboBox ItemsSource="{Binding Battalions}"
                          SelectedItem="{Binding SelectedBattalion}"
                          Background="#333333"
                          Foreground="White"
                          HorizontalAlignment="Stretch"
                          PlaceholderText="ëŒ€ëŒ€ ì„ íƒ">
                  <ComboBox.ItemTemplate>
                    <DataTemplate>
                      <TextBlock Text="{Binding Name}"/>
                    </DataTemplate>
                  </ComboBox.ItemTemplate>
                </ComboBox>
              </StackPanel>

              <!-- ì—…ì²´ ê²€ìƒ‰ -->
              <StackPanel Spacing="4">
                <TextBlock Text="ì—…ì²´ ê²€ìƒ‰" Foreground="#AAAAAA" FontSize="12"/>

                <!-- ì„ íƒëœ ì—…ì²´ê°€ ì—†ì„ ë•Œ: ê²€ìƒ‰ ìž…ë ¥ -->
                <Grid IsVisible="{Binding SelectedCompany, Converter={x:Static ObjectConverters.IsNull}}">
                  <TextBox Text="{Binding CompanySearchText}"
                           Watermark="{Binding CompanySearchPlaceholder}"
                           Background="#333333"
                           Foreground="White"
                           Padding="10"
                           IsEnabled="{Binding SelectedDistrict, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                </Grid>

                <!-- ì„ íƒëœ ì—…ì²´ê°€ ìžˆì„ ë•Œ: ì„ íƒëœ ì—…ì²´ í‘œì‹œ -->
                <Border Background="#333333" CornerRadius="6" Padding="10"
                        IsVisible="{Binding SelectedCompany, Converter={x:Static ObjectConverters.IsNotNull}}">
                  <Grid ColumnDefinitions="*,Auto">
                    <StackPanel Grid.Column="0" Spacing="2">
                      <TextBlock Text="{Binding SelectedCompany.Name}" FontSize="14" Foreground="White"/>
                      <TextBlock Text="{Binding SelectedCompany.Address}" FontSize="11" Foreground="#888888"
                                 TextTrimming="CharacterEllipsis"/>
                    </StackPanel>
                    <Button Grid.Column="1" Command="{Binding ClearCompanySelectionCommand}"
                            Background="Transparent" Padding="8,4" VerticalAlignment="Center">
                      <TextBlock Text="âœ•" FontSize="14" Foreground="#888888"/>
                    </Button>
                  </Grid>
                </Border>

                <!-- ê²€ìƒ‰ ê²°ê³¼ ëª©ë¡ -->
                <Border Background="#2A2A2A" CornerRadius="6" Padding="4"
                        IsVisible="{Binding ShowCompanySearchResults}"
                        MaxHeight="200">
                  <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding SearchedCompanies}">
                      <ItemsControl.ItemTemplate>
                        <DataTemplate>
                          <Button Command="{Binding $parent[ItemsControl].((vm:ScheduleCreateViewModel)DataContext).SelectCompanyCommand}"
                                  CommandParameter="{Binding}"
                                  Background="Transparent"
                                  HorizontalAlignment="Stretch"
                                  HorizontalContentAlignment="Stretch"
                                  Padding="8,6"
                                  Margin="0,2">
                            <StackPanel Spacing="2">
                              <TextBlock Text="{Binding Name}" FontSize="13" Foreground="White"/>
                              <TextBlock Text="{Binding Address}" FontSize="10" Foreground="#888888"
                                         TextTrimming="CharacterEllipsis"/>
                            </StackPanel>
                          </Button>
                        </DataTemplate>
                      </ItemsControl.ItemTemplate>
                    </ItemsControl>
                  </ScrollViewer>
                </Border>

                <!-- ê²€ìƒ‰ ì•ˆë‚´ -->
                <TextBlock Text="2ê¸€ìž ì´ìƒ ìž…ë ¥í•˜ë©´ í•´ë‹¹ ì§€ì—­ì˜ ì—…ì²´ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤."
                           FontSize="10" Foreground="#666666"
                           IsVisible="{Binding SelectedCompany, Converter={x:Static ObjectConverters.IsNull}}"/>
              </StackPanel>
            </StackPanel>
          </Border>

          <!-- ìžë™ ì—°ê²° ì •ë³´ -->
          <Border Background="#1A1A1A" CornerRadius="10" Padding="16"
                  IsVisible="{Binding ShowAutoInfo}">
            <StackPanel Spacing="12">
              <TextBlock Text="ðŸ‘ï¸ ìžë™ ì—°ê²° ì •ë³´" FontSize="14" Foreground="#888888"/>

              <!-- ì—…ì²´ ì •ë³´ -->
              <StackPanel Spacing="4"
                          IsVisible="{Binding SelectedCompany, Converter={x:Static ObjectConverters.IsNotNull}}">
                <TextBlock Text="ì—…ì²´ ì •ë³´" FontSize="12" Foreground="#666666"/>
                <TextBlock Text="{Binding CompanyAddress}" FontSize="13" Foreground="#4CAF50"
                           TextWrapping="Wrap"
                           IsVisible="{Binding CompanyAddress, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                <TextBlock Text="{Binding CompanyProducts}" FontSize="13" Foreground="#FF9800"
                           TextWrapping="Wrap"
                           IsVisible="{Binding CompanyProducts, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
              </StackPanel>

              <!-- ì§€ìžì²´ë‹´ë‹¹ìž ì •ë³´ -->
              <StackPanel Spacing="4"
                          IsVisible="{Binding SelectedDistrict, Converter={x:Static ObjectConverters.IsNotNull}}">
                <TextBlock Text="ì§€ìžì²´ë‹´ë‹¹ìž" FontSize="12" Foreground="#666666"/>
                <Panel>
                  <TextBlock Text="{Binding LocalUserName}" FontSize="13" Foreground="#2196F3"
                             IsVisible="{Binding HasLocalUser}"/>
                  <TextBlock Text="{Binding LocalUserName}" FontSize="13" Foreground="#F44336"
                             IsVisible="{Binding !HasLocalUser}"/>
                </Panel>
                <TextBlock Text="{Binding LocalUserPhone}" FontSize="12" Foreground="#888888"
                           IsVisible="{Binding HasLocalUser}"/>
              </StackPanel>

              <!-- ëŒ€ëŒ€ë‹´ë‹¹ìž ì •ë³´ -->
              <StackPanel Spacing="4"
                          IsVisible="{Binding SelectedBattalion, Converter={x:Static ObjectConverters.IsNotNull}}">
                <TextBlock Text="ëŒ€ëŒ€ë‹´ë‹¹ìž" FontSize="12" Foreground="#666666"/>
                <Panel>
                  <TextBlock Text="{Binding MilitaryUserName}" FontSize="13" Foreground="#FF9800"
                             IsVisible="{Binding HasMilitaryUser}"/>
                  <TextBlock Text="{Binding MilitaryUserName}" FontSize="13" Foreground="#F44336"
                             IsVisible="{Binding !HasMilitaryUser}"/>
                </Panel>
                <TextBlock Text="{Binding MilitaryUserPhone}" FontSize="12" Foreground="#888888"
                           IsVisible="{Binding HasMilitaryUser}"/>
              </StackPanel>
            </StackPanel>
          </Border>

          <!-- ì¼ì • ìƒì„± ë²„íŠ¼ -->
          <Panel Margin="0,8,0,0">
            <Button Command="{Binding CreateScheduleCommand}"
                    Background="#FF9800"
                    HorizontalAlignment="Stretch"
                    HorizontalContentAlignment="Center"
                    Padding="16"
                    CornerRadius="8"
                    IsVisible="{Binding CanCreate}">
              <TextBlock Text="ì¼ì • ìƒì„±" FontSize="16" Foreground="White" FontWeight="Bold"/>
            </Button>
            <Button Background="#555555"
                    HorizontalAlignment="Stretch"
                    HorizontalContentAlignment="Center"
                    Padding="16"
                    CornerRadius="8"
                    IsEnabled="False"
                    IsVisible="{Binding !CanCreate}">
              <TextBlock Text="ì¼ì • ìƒì„±" FontSize="16" Foreground="#888888" FontWeight="Bold"/>
            </Button>
          </Panel>

          <!-- ì•ˆë‚´ ë¬¸êµ¬ -->
          <TextBlock Text="ì¼ì •ì´ ìƒì„±ë˜ë©´ ì§€ìžì²´ë‹´ë‹¹ìžì—ê²Œ ì•Œë¦¼ì´ ë°œì†¡ë©ë‹ˆë‹¤."
                     FontSize="11" Foreground="#666666" HorizontalAlignment="Center"
                     TextWrapping="Wrap"/>
        </StackPanel>
      </ScrollViewer>
    </Grid>
  </Grid>
</UserControl>
